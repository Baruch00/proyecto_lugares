<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <title>Lugares y reseñas</title>

  <!-- estilos globales -->
  <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
  <!-- estilos públicos -->
  <link rel="stylesheet" href="{{ url_for('static', filename='css/public.css') }}">
</head>

<body class="public-page">

  <!-- ===== HEADER ===== -->
  <header class="site-header">
    <div class="container header-inner">
      <div>
        <p class="site-subtitle">Proyecto Lugares · Vista pública</p>
        <h1 class="site-title">Lugares y reseñas</h1>
        <p class="site-lead">
          Consulta el promedio de calificación de cada lugar, escribe nuevas reseñas
          o revisa las opiniones existentes.
        </p>
      </div>

      <nav class="site-nav">
        <a href="{{ url_for('index') }}" class="nav-link">Inicio</a>
        <a href="#lista" class="nav-link">Ver lugares</a>
      </nav>
    </div>
  </header>

  <main class="public-main">

    <!-- ===== SECCIÓN PRINCIPAL ===== -->
    <section class="list-section" id="lista">
      <div class="container">

        <div class="section-header">
          <h2>Lugares disponibles</h2>
          <p>
            Cada tarjeta muestra el nombre, la dirección y el promedio de estrellas
            (si ya tiene reseñas registradas).
          </p>
        </div>

        {% if lugares and lugares|length > 0 %}
        <div class="results-grid">
          {% for l in lugares %}
            {# l[0]=id, l[1]=nombre, l[2]=direccion #}
            <article class="place-card">
              <div class="place-body">
                <div class="place-top">
                  <h3 class="place-title">{{ l[1] }}</h3>
                  <span class="place-tag">Lugar</span>
                </div>

                <p class="place-address">{{ l[2] }}</p>

                <p class="place-desc">
                  {% set p = promedios.get(l[0]) %}
                  <strong>Promedio de calificación:</strong>
                  {% if p and p[0] is not none %}
                    {{ "%.1f"|format(p[0]) }} ⭐
                  {% else %}
                    Sin reseñas todavía.
                  {% endif %}
                </p>

                <div class="place-actions">
                  <a class="btn btn-outline btn-small"
                     href="/resena/{{ l[0] }}">
                    Escribir reseña
                  </a>

                  <a class="btn btn-primary btn-small"
                     href="/resenas/{{ l[0] }}">
                    Ver reseñas
                  </a>
                </div>
              </div>
            </article>
          {% endfor %}
        </div>
        {% else %}
          <div class="empty-block">
            <h3>Aún no hay lugares registrados</h3>
            <p>Cuando existan lugares en la base de datos aparecerán aquí.</p>
          </div>
        {% endif %}

      </div>
    </section>

  </main>

  <footer class="site-footer">
    <div class="container">
      <p>Proyecto Lugares · Vista pública de reseñas</p>
    </div>
  </footer>

</body>
</html>